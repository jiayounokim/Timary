ext {
    buildVersionCode = {
        def candidate = "99"

        def (major, minor, patch) = timaryVersion.toLowerCase().replaceAll('-', '').tokenize('.')

        if (patch.endsWith("debug")) {
            candidate = "0"
            patch = patch.replaceAll("[^0-9]", "")
        } else {
            def qa
            (patch, qa) = patch.tokenize("qa")

            if (qa) {
                candidate = qa
            }
        }

        (major, minor, patch, candidate) = [major, minor, patch, candidate].collect { it.toInteger() }

        (major * 1000000) + (minor * 10000) + (patch * 100) + candidate
    }

    buildVersionName = { versionName, buildQualifier ->
        return versionName + buildQualifier
    }

    getApkName = { versionName, buildType, buildQualifier ->
        "timary-${versionName}-${buildType}-${buildQualifier}.apk"
    }
}